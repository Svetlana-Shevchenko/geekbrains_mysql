#1 задание


mysql root@localhost:shop> SELECT * from users;
+------+-----------+---------------+---------------------+---------------------+
|   id | name      | birthday_at   | created_at          | updated_at          |
|------+-----------+---------------+---------------------+---------------------|
|    1 | Геннадий  | 1990-10-05    | 2020-02-12 11:12:22 | 2020-02-12 11:12:22 |
|    2 | Наталья   | 1984-11-12    | 2020-02-12 11:12:22 | 2020-02-12 11:12:22 |
|    3 | Александр | 1985-05-20    | 2020-02-12 11:12:22 | 2020-02-12 11:12:22 |
|    4 | Сергей    | 1988-02-14    | 2020-02-12 11:12:22 | 2020-02-12 11:12:22 |
|    5 | Иван      | 1998-01-12    | 2020-02-12 11:12:22 | 2020-02-12 11:12:22 |
|    6 | Мария     | 1992-08-29    | 2020-02-12 11:12:22 | 2020-02-12 11:12:22 |
+------+-----------+---------------+---------------------+---------------------+
6 rows in set
Time: 0.002s

mysql root@localhost:shop> update users set created_at = NOW(), updated_at= NOW()
Query OK, 6 rows affected
Time: 0.005s

mysql root@localhost:shop> select * from users;
+------+-----------+---------------+---------------------+---------------------+
|   id | name      | birthday_at   | created_at          | updated_at          |
|------+-----------+---------------+---------------------+---------------------|
|    1 | Геннадий  | 1990-10-05    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    2 | Наталья   | 1984-11-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    3 | Александр | 1985-05-20    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    4 | Сергей    | 1988-02-14    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    5 | Иван      | 1998-01-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    6 | Мария     | 1992-08-29    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
+------+-----------+---------------+---------------------+---------------------+
6 rows in set
Time: 0.002s


# 2 Задание 



mysql root@localhost:shop> show tables;
+----------------------+
| Tables_in_shop       |
|----------------------|
| catalogs             |
| discounts            |
| orders               |
| orders_products      |
| products             |
| storehouses          |
| storehouses_products |
| tbl                  |
| users                |
+----------------------+
9 rows in set
Time: 0.002s

mysql root@localhost:shop> desc users;
+-------------+---------------------+--------+-------+-------------------+-----------------------------+
| Field       | Type                | Null   | Key   | Default           | Extra                       |
|-------------+---------------------+--------+-------+-------------------+-----------------------------|
| id          | bigint(20) unsigned | NO     | PRI   | <null>            | auto_increment              |
| name        | varchar(255)        | YES    |       | <null>            |                             |
| birthday_at | date                | YES    |       | <null>            |                             |
| created_at  | datetime            | YES    |       | CURRENT_TIMESTAMP |                             |
| updated_at  | datetime            | YES    |       | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |
+-------------+---------------------+--------+-------+-------------------+-----------------------------+
5 rows in set
Time: 0.002s

mysql root@localhost:shop> select * from users;
+------+-----------+---------------+---------------------+---------------------+
|   id | name      | birthday_at   | created_at          | updated_at          |
|------+-----------+---------------+---------------------+---------------------|
|    1 | Геннадий  | 1990-10-05    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    2 | Наталья   | 1984-11-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    3 | Александр | 1985-05-20    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    4 | Сергей    | 1988-02-14    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    5 | Иван      | 1998-01-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    6 | Мария     | 1992-08-29    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
+------+-----------+---------------+---------------------+---------------------+
6 rows in set
Time: 0.002s


mysql root@localhost:shop> CREATE TABLE users2 (
                           
                             id SERIAL PRIMARY KEY,
                           
                             name VARCHAR(255) COMMENT 'Имя покупателя',
                           
                             birthday_at DATE COMMENT 'Дата рождения',
                           
                             created_at VARCHAR(255),
                           
                             updated_at VARCHAR(255)
                           
                           ) COMMENT = 'Покупатели';
                           
Query OK, 0 rows affected
Time: 0.040s

mysql root@localhost:shop> desc users2
                           ;
+-------------+---------------------+--------+-------+-----------+----------------+
| Field       | Type                | Null   | Key   |   Default | Extra          |
|-------------+---------------------+--------+-------+-----------+----------------|
| id          | bigint(20) unsigned | NO     | PRI   |    <null> | auto_increment |
| name        | varchar(255)        | YES    |       |    <null> |                |
| birthday_at | date                | YES    |       |    <null> |                |
| created_at  | varchar(255)        | YES    |       |    <null> |                |
| updated_at  | varchar(255)        | YES    |       |    <null> |                |
+-------------+---------------------+--------+-------+-----------+----------------+
5 rows in set
Time: 0.003s

mysql root@localhost:shop> INSERT INTO users2 (name, created_at) VALUES
                           
                             ('Геннадий', '20.10.2017 8:10'),
                           
                             ('Наталья', '20.10.2017 8:11'),
                           
                             ('Александр', '20.10.2017 8:12'),
                           
                             ('Сергей', '20.10.2017 8:15'),
                           
                             ('Иван', '20.10.2017 8:20'),
                           
                             ('Мария', '20.10.2017 8:44');
                           
Query OK, 6 rows affected
Time: 0.007s

mysql root@localhost:shop> select * from users2;
+------+-----------+---------------+-----------------+--------------+
|   id | name      |   birthday_at | created_at      |   updated_at |
|------+-----------+---------------+-----------------+--------------|
|    1 | Геннадий  |        <null> | 20.10.2017 8:10 |       <null> |
|    2 | Наталья   |        <null> | 20.10.2017 8:11 |       <null> |
|    3 | Александр |        <null> | 20.10.2017 8:12 |       <null> |
|    4 | Сергей    |        <null> | 20.10.2017 8:15 |       <null> |
|    5 | Иван      |        <null> | 20.10.2017 8:20 |       <null> |
|    6 | Мария     |        <null> | 20.10.2017 8:44 |       <null> |
+------+-----------+---------------+-----------------+--------------+
6 rows in set
Time: 0.002s

mysql root@localhost:shop> update users2 set created_at = STR_TO_DATE(created_at, '%d.%m.%Y %H:%i');
Query OK, 6 rows affected
Time: 0.007s

mysql root@localhost:shop> select * from users2;
+------+-----------+---------------+---------------------+--------------+
|   id | name      |   birthday_at | created_at          |   updated_at |
|------+-----------+---------------+---------------------+--------------|
|    1 | Геннадий  |        <null> | 2017-10-20 08:10:00 |       <null> |
|    2 | Наталья   |        <null> | 2017-10-20 08:11:00 |       <null> |
|    3 | Александр |        <null> | 2017-10-20 08:12:00 |       <null> |
|    4 | Сергей    |        <null> | 2017-10-20 08:15:00 |       <null> |
|    5 | Иван      |        <null> | 2017-10-20 08:20:00 |       <null> |
|    6 | Мария     |        <null> | 2017-10-20 08:44:00 |       <null> |
+------+-----------+---------------+---------------------+--------------+
6 rows in set
Time: 0.004s

mysql root@localhost:shop> ALTER TABLE users2 MODIFY created_at DATETIME;
Query OK, 6 rows affected
Time: 0.058s

mysql root@localhost:shop> select * from users2;
+------+-----------+---------------+---------------------+--------------+
|   id | name      |   birthday_at | created_at          |   updated_at |
|------+-----------+---------------+---------------------+--------------|
|    1 | Геннадий  |        <null> | 2017-10-20 08:10:00 |       <null> |
|    2 | Наталья   |        <null> | 2017-10-20 08:11:00 |       <null> |
|    3 | Александр |        <null> | 2017-10-20 08:12:00 |       <null> |
|    4 | Сергей    |        <null> | 2017-10-20 08:15:00 |       <null> |
|    5 | Иван      |        <null> | 2017-10-20 08:20:00 |       <null> |
|    6 | Мария     |        <null> | 2017-10-20 08:44:00 |       <null> |
+------+-----------+---------------+---------------------+--------------+
6 rows in set
Time: 0.002s

mysql root@localhost:shop> desc users2;
+-------------+---------------------+--------+-------+-----------+----------------+
| Field       | Type                | Null   | Key   |   Default | Extra          |
|-------------+---------------------+--------+-------+-----------+----------------|
| id          | bigint(20) unsigned | NO     | PRI   |    <null> | auto_increment |
| name        | varchar(255)        | YES    |       |    <null> |                |
| birthday_at | date                | YES    |       |    <null> |                |
| created_at  | datetime            | YES    |       |    <null> |                |
| updated_at  | varchar(255)        | YES    |       |    <null> |                |
+-------------+---------------------+--------+-------+-----------+----------------+
5 rows in set
Time: 0.002s


# 3 Задание 


mysql root@localhost:shop> desc storehouses_products;
+---------------+---------------------+--------+-------+-------------------+-----------------------------+
| Field         | Type                | Null   | Key   | Default           | Extra                       |
|---------------+---------------------+--------+-------+-------------------+-----------------------------|
| id            | bigint(20) unsigned | NO     | PRI   | <null>            | auto_increment              |
| storehouse_id | int(10) unsigned    | YES    |       | <null>            |                             |
| product_id    | int(10) unsigned    | YES    |       | <null>            |                             |
| value         | int(10) unsigned    | YES    |       | <null>            |                             |
| created_at    | datetime            | YES    |       | CURRENT_TIMESTAMP |                             |
| updated_at    | datetime            | YES    |       | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |
+---------------+---------------------+--------+-------+-------------------+-----------------------------+
6 rows in set
Time: 0.004s

mysql root@localhost:shop> insert into storehouses_products (storehouse_id, product_id, value) VALUES (1,10,0), (1,11,0), (1,12,0), (1,13,0), (1,100,10), (1,101,20), (1,103,8);
Query OK, 7 rows affected
Time: 0.007s

mysql root@localhost:shop> select * from storehouses_products ;
+------+-----------------+--------------+---------+---------------------+---------------------+
|   id |   storehouse_id |   product_id |   value | created_at          | updated_at          |
|------+-----------------+--------------+---------+---------------------+---------------------|
|    1 |               1 |           10 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    2 |               1 |           11 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    3 |               1 |           12 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    4 |               1 |           13 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    5 |               1 |          100 |      10 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    6 |               1 |          101 |      20 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    7 |               1 |          103 |       8 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
+------+-----------------+--------------+---------+---------------------+---------------------+
7 rows in set
Time: 0.002s

mysql root@localhost:shop> select * from storehouses_products ORDER BY value DESC;
+------+-----------------+--------------+---------+---------------------+---------------------+
|   id |   storehouse_id |   product_id |   value | created_at          | updated_at          |
|------+-----------------+--------------+---------+---------------------+---------------------|
|    6 |               1 |          101 |      20 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    5 |               1 |          100 |      10 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    7 |               1 |          103 |       8 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    1 |               1 |           10 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    2 |               1 |           11 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    3 |               1 |           12 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    4 |               1 |           13 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
+------+-----------------+--------------+---------+---------------------+---------------------+
7 rows in set
Time: 0.002s

mysql root@localhost:shop> select * from storehouses_products ORDER BY IF(value = 0, 1 ,0), value;
+------+-----------------+--------------+---------+---------------------+---------------------+
|   id |   storehouse_id |   product_id |   value | created_at          | updated_at          |
|------+-----------------+--------------+---------+---------------------+---------------------|
|    7 |               1 |          103 |       8 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    5 |               1 |          100 |      10 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    6 |               1 |          101 |      20 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    1 |               1 |           10 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    2 |               1 |           11 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    3 |               1 |           12 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
|    4 |               1 |           13 |       0 | 2020-02-12 11:35:18 | 2020-02-12 11:35:18 |
+------+-----------------+--------------+---------+---------------------+---------------------+
7 rows in set
Time: 0.002s


# 4 задание


mysql root@localhost:shop> select * from users;
+------+-----------+---------------+---------------------+---------------------+
|   id | name      | birthday_at   | created_at          | updated_at          |
|------+-----------+---------------+---------------------+---------------------|
|    1 | Геннадий  | 1990-10-05    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    2 | Наталья   | 1984-11-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    3 | Александр | 1985-05-20    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    4 | Сергей    | 1988-02-14    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    5 | Иван      | 1998-01-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    6 | Мария     | 1992-08-29    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
+------+-----------+---------------+---------------------+---------------------+
6 rows in set


mysql root@localhost:shop> select id, name, birthday_at from users where MONTH(birthday_at) IN (5,8);
+------+-----------+---------------+
|   id | name      | birthday_at   |
|------+-----------+---------------|
|    3 | Александр | 1985-05-20    |
|    6 | Мария     | 1992-08-29    |
+------+-----------+---------------+
2 rows in set
Time: 0.003s

mysql root@localhost:shop> select id, name, birthday_at, MONTH(birthday_at) as name_month from users where MONTH(birthday_at) IN (5,8);
+------+-----------+---------------+--------------+
|   id | name      | birthday_at   |   name_month |
|------+-----------+---------------+--------------|
|    3 | Александр | 1985-05-20    |            5 |
|    6 | Мария     | 1992-08-29    |            8 |
+------+-----------+---------------+--------------+
2 rows in set
Time: 0.002s

mysql root@localhost:shop> select id, name, birthday_at, DATE_FORMAT(birthday_at, '%M') as name_month from users where MONTH(birthday_at) IN (5,8);
+------+-----------+---------------+--------------+
|   id | name      | birthday_at   | name_month   |
|------+-----------+---------------+--------------|
|    3 | Александр | 1985-05-20    | May          |
|    6 | Мария     | 1992-08-29    | August       |
+------+-----------+---------------+--------------+
2 rows in set
Time: 0.003s

# 5 Задание
mysql root@localhost:shop> select * from catalogs where id in (5,1,2)
                           ;
+------+--------------------+
|   id | name               |
|------+--------------------|
|    1 | Процессоры         |
|    2 | Материнские платы  |
|    5 | Оперативная память |
+------+--------------------+
3 rows in set
Time: 0.003s

mysql root@localhost:shop> select * from catalogs where id in (5,1,2) order by FIELD(id, 5,1,2);
+------+--------------------+
|   id | name               |
|------+--------------------|
|    5 | Оперативная память |
|    1 | Процессоры         |
|    2 | Материнские платы  |
+------+--------------------+
3 rows in set
Time: 0.003s

# 6 Задание 


mysql root@localhost:shop> select * from users;
+------+-----------+---------------+---------------------+---------------------+
|   id | name      | birthday_at   | created_at          | updated_at          |
|------+-----------+---------------+---------------------+---------------------|
|    1 | Геннадий  | 1990-10-05    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    2 | Наталья   | 1984-11-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    3 | Александр | 1985-05-20    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    4 | Сергей    | 1988-02-14    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    5 | Иван      | 1998-01-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    6 | Мария     | 1992-08-29    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
+------+-----------+---------------+---------------------+---------------------+
6 rows in set
Time: 0.002s

mysql root@localhost:shop> select * from users;
+------+-----------+---------------+---------------------+---------------------+
|   id | name      | birthday_at   | created_at          | updated_at          |
|------+-----------+---------------+---------------------+---------------------|
|    1 | Геннадий  | 1990-10-05    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    2 | Наталья   | 1984-11-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    3 | Александр | 1985-05-20    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    4 | Сергей    | 1988-02-14    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    5 | Иван      | 1998-01-12    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
|    6 | Мария     | 1992-08-29    | 2020-02-12 11:14:10 | 2020-02-12 11:14:10 |
+------+-----------+---------------+---------------------+---------------------+
6 rows in set
Time: 0.004s

mysql root@localhost:shop> select TIMESTAMPDIFF(YEAR, birthday_at, CURDATE()) as age from users;
+-------+
|   age |
|-------|
|    29 |
|    35 |
|    34 |
|    31 |
|    22 |
|    27 |
+-------+
6 rows in set
Time: 0.002s

mysql root@localhost:shop> select AVG(TIMESTAMPDIFF(YEAR, birthday_at, CURDATE())) as age from users;
+---------+
| age     |
|---------|
| 29.6667 |
+---------+
1 row in set
Time: 0.001s


#7 Задание

mysql root@localhost:shop> select DATE_FORMAT(birthday_at, '%d %m') day_of_week  from users;
+---------------+
| day_of_week   |
|---------------|
| 05 10         |
| 12 11         |
| 20 05         |
| 14 02         |
| 12 01         |
| 29 08         |
+---------------+
6 rows in set
Time: 0.002s

mysql root@localhost:shop> select DAYNAME(DATE_FORMAT(birthday_at, '2019-%m-%d')) day_of_week  from users;
+---------------+
| day_of_week   |
|---------------|
| Saturday      |
| Tuesday       |
| Monday        |
| Thursday      |
| Saturday      |
| Thursday      |
+---------------+
6 rows in set
Time: 0.001s

mysql root@localhost:shop> select count(day_of_week), day_of_week from  (select DAYNAME(DATE_FORMAT(birthday_at, '2019-%m-%d')) day_of_week  from users) as days GROUP BY day_of_week;
+----------------------+---------------+
|   count(day_of_week) | day_of_week   |
|----------------------+---------------|
|                    1 | Monday        |
|                    2 | Saturday      |
|                    2 | Thursday      |
|                    1 | Tuesday       |
+----------------------+---------------+
4 rows in set
Time: 0.003s

mysql root@localhost:shop> select count(day_of_week), day_of_week from  (select DAYNAME(DATE_FORMAT(birthday_at, '2019-%m-%d')) day_of_week  from users) as days GROUP BY day_of_week ;
+----------------------+---------------+
|   count(day_of_week) | day_of_week   |
|----------------------+---------------|
|                    1 | Monday        |
|                    2 | Saturday      |
|                    2 | Thursday      |
|                    1 | Tuesday       |
+----------------------+---------------+
4 rows in set
Time: 0.003s

# 8 Задание 

mysql root@localhost:shop> create table last (value int null);
Query OK, 0 rows affected
Time: 0.024s

mysql root@localhost:shop> INSERT INTO last (value) values  (1)  , (2) ,(3), (4),(5);
Query OK, 5 rows affected
Time: 0.008s

mysql root@localhost:shop> select * from last;
+---------+
|   value |
|---------|
|       1 |
|       2 |
|       3 |
|       4 |
|       5 |
+---------+

mysql root@localhost:shop> select EXP(SUM(LOG(value))) from last;
+------------------------+
|   EXP(SUM(LOG(value))) |
|------------------------|
|                    120 |
+------------------------+
1 row in set
Time: 0.001s
